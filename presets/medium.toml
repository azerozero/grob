# Preset: medium - Best quality/price ratio
# Anthropic OAuth for thinking, OpenRouter for everything else
# Requires: OpenRouter API key (OPENROUTER_API_KEY) + Anthropic OAuth
#
# ── Cout estime (8h/jour, 22j/mois) ──────────────────────
#
#   Ce preset (Pro $20/mois, Opus thinking + OpenRouter):
#     Sans agent : ~€30/mois  ($20 Pro + ~€10 OpenRouter)
#     Avec agent : ~€120/mois ($20 Pro + ~€100 OpenRouter)
#     Opus rate-limite sur Pro → fallback Sonnet puis DeepSeek
#
#   Avec Max $200/mois (rate limits Opus plus eleves):
#     Sans agent : ~€210/mois ($200 Max + ~€10 OpenRouter)
#     Avec agent : ~€300/mois ($200 Max + ~€100 OpenRouter)
#
#   Sans abonnement (tout via OpenRouter):
#     Sans agent : ~€50-80/mois  (Kimi/Grok $0.30-0.50/M in)
#     Avec agent : ~€300-600/mois
#
#   Via OpenRouter seul (credit initial €20):
#     €20 = ~1-2 semaines sans agent, ~2-3 jours avec agent
#
#   Comparaison OpenAI seul (GPT-4o $2.50/$10 par M tokens):
#     Sans agent : ~€90/mois
#     Avec agent : ~€900/mois
#
#   Alternative locale:
#     Mac Mini M4 Pro 48GB  : €1800 → €52/mois sur 3 ans + elec
#     Mac Studio M4 Max 128GB: €5000 → €144/mois sur 3 ans + elec
#     Electricite (FR €0.25/kWh): €2-5/mois
#     Apres amortissement : €2-5/mois (elec seule)

# --- Providers ---

# Anthropic via OAuth (Pro $20/mois = Opus + Sonnet, Max $200/mois = limites plus hautes)
[[providers]]
name = "anthropic-max"
provider_type = "anthropic"
auth_type = "oauth"
oauth_provider = "anthropic-max"
enabled = true
models = []

# OpenRouter (modeles performants pas chers)
[[providers]]
name = "openrouter"
provider_type = "openrouter"
api_key = "$OPENROUTER_API_KEY"
enabled = true
models = []

# --- Models ---

# Think - claude-opus-4-6 via Anthropic Max OAuth (included in subscription)
# Fallback: sonnet (still Max), then deepseek-v3.2 via OpenRouter if Max rate-limited
[[models]]
name = "claude-opus-thinking"

[[models.mappings]]
provider = "anthropic-max"
actual_model = "claude-opus-4-6"
priority = 1

[[models.mappings]]
provider = "anthropic-max"
actual_model = "claude-sonnet-4-6"
priority = 2

[[models.mappings]]
provider = "openrouter"
actual_model = "deepseek/deepseek-v3.2"
priority = 3

# Default - kimi-k2.5 (excellent ratio)
# ELO 1514, ~$0.30/$1.10 per M tokens
[[models]]
name = "default"

[[models.mappings]]
provider = "openrouter"
actual_model = "moonshotai/kimi-k2.5-0127"
priority = 1

[[models.mappings]]
provider = "openrouter"
actual_model = "deepseek/deepseek-v3.2"
priority = 2

# Background - grok-4.1-fast (fast + cheap)
# ELO 1495, ~$0.50/$1.00 per M
[[models]]
name = "background"

[[models.mappings]]
provider = "openrouter"
actual_model = "x-ai/grok-4.1-fast"
priority = 1

[[models.mappings]]
provider = "openrouter"
actual_model = "moonshotai/kimi-k2-thinking-20251106"
priority = 2

# WebSearch - glm-5 (good at search)
# ELO 1495, ~$0.30/$2.55 per M
[[models]]
name = "websearch"

[[models.mappings]]
provider = "openrouter"
actual_model = "z-ai/glm-5"
priority = 1

[[models.mappings]]
provider = "openrouter"
actual_model = "anthropic/claude-sonnet-4-6"
priority = 2

# --- Router ---
[router]
default = "default"
think = "claude-opus-thinking"
background = "background"
websearch = "websearch"
auto_map_regex = "^claude-"
background_regex = "(?i)claude.*haiku"
