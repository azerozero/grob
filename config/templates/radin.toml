# ═══════════════════════════════════════════════════════════
# Grob Config: RADIN (Budget)
# ═══════════════════════════════════════════════════════════
# Best price/performance ratio. Uses free/cheap open models
# for routine tasks, Claude thinking only when needed.
#
# Leaderboard scores (Chatbot Arena, Feb 2026):
#   glm-5           1452  (MIT, free tier)
#   kimi-k2.5-think 1436  (Modified MIT)
#   deepseek-v3.2   1318  (MIT, very cheap)
#   gemini-3-flash  1440  (free tier, 1M ctx)
#
# Monthly cost estimate: $0-5/month for moderate use
# ═══════════════════════════════════════════════════════════

[server]
port = 13456
host = "::1"
log_level = "info"

[server.timeouts]
api_timeout_ms = 600000
connect_timeout_ms = 10000

[budget]
monthly_limit_usd = 10.0
warn_at_percent = 80

# ── Providers ────────────────────────────────────────────

# DeepSeek API — MIT models, cheapest inference (< $0.14/M input, $0.28/M output)
[[providers]]
name = "deepseek"
provider_type = "openrouter"
base_url = "https://openrouter.ai/api/v1"
api_key = "$OPENROUTER_API_KEY"
enabled = true
models = []

# Z.ai — GLM models, free tier available
[[providers]]
name = "zai"
provider_type = "z.ai"
api_key = "$ZAI_API_KEY"
enabled = true
models = []

# Google Gemini — generous free tier (1500 req/day)
[[providers]]
name = "gemini"
provider_type = "gemini"
api_key = "$GEMINI_API_KEY"
enabled = true
models = []

# Kimi Coding — Claude-compatible API, competitive pricing
[[providers]]
name = "kimi"
provider_type = "anthropic"
base_url = "https://api.kimi.com/coding/"
api_key = "$KIMI_API_KEY"
enabled = true
models = []

# OpenRouter — universal fallback, pay-per-use
[[providers]]
name = "openrouter"
provider_type = "openrouter"
api_key = "$OPENROUTER_API_KEY"
enabled = true
models = []

# ── Models ───────────────────────────────────────────────

# Default model: GLM-5 (score 1452, MIT, free)
[[models]]
name = "default-model"

  [[models.mappings]]
  priority = 1
  provider = "zai"
  actual_model = "glm-5"

  [[models.mappings]]
  priority = 2
  provider = "openrouter"
  actual_model = "z-ai/glm-5"

# Thinking model: DeepSeek v3.2 thinking (score 1370, MIT, cheap)
[[models]]
name = "think-model"

  [[models.mappings]]
  priority = 1
  provider = "openrouter"
  actual_model = "deepseek/deepseek-r1"

  [[models.mappings]]
  priority = 2
  provider = "kimi"
  actual_model = "claude-sonnet-4-6-20250514"

# Background model: DeepSeek v3.2 (score 1318, MIT, cheapest)
[[models]]
name = "background-model"

  [[models.mappings]]
  priority = 1
  provider = "openrouter"
  actual_model = "deepseek/deepseek-chat"

  [[models.mappings]]
  priority = 2
  provider = "zai"
  actual_model = "glm-4.5-air"

# Web search model: Gemini 3 Flash (score 1440, free tier)
[[models]]
name = "search-model"

  [[models.mappings]]
  priority = 1
  provider = "gemini"
  actual_model = "gemini-3-flash"

  [[models.mappings]]
  priority = 2
  provider = "openrouter"
  actual_model = "google/gemini-3-flash"

# ── Router ───────────────────────────────────────────────

[router]
default = "default-model"
think = "think-model"
background = "background-model"
websearch = "search-model"

# Route heavy coding tasks to thinking model
[[router.prompt_rules]]
pattern = "(?i)(refactor|architect|design|implement.*complex|debug.*hard)"
model = "think-model"

# Route simple tasks to cheapest model
[[router.prompt_rules]]
pattern = "(?i)(format|lint|rename|typo|simple.*fix)"
model = "background-model"
